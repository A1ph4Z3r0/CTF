# sQRt(follow the white rabbit)

## Problem

![QR Code](./files/qr1.png)

## Solution

Simply scanning the QR code,

```shell
$ zbarimg qr1.png
QR-Code:This is the key. Now... follow the white rabbit.
scanned 1 barcode symbols from 1 images in 0.14 seconds
```

Upon inspecting the image's metadata, we find some interesting text

```shell
$ exiftool qr1.png
ExifTool Version Number         : 10.80
File Name                       : qr1.png
Directory                       : .
File Size                       : 14 kB
File Modification Date/Time     : 2019:11:06 07:47:36-05:00
File Access Date/Time           : 2019:11:06 07:47:32-05:00
File Inode Change Date/Time     : 2019:11:06 07:47:36-05:00
File Permissions                : rwxrwxrwx
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 410
Image Height                    : 410
Bit Depth                       : 1
Color Type                      : Grayscale
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Tag 23 BR4                      : 0 1101 0 11 101110101110001   011111 10 111  1 100 01 011 110010 000  0111 1100   010   10 1010011 01 100001  000  0010  0011 1   0 10000 0    0001 1001000 11  110 1 1   10 10 001110  100  001 11 00110 0000000101 1 100   100  010  110011111100    0 00 1  000 00011 0001000 11 10 111001  011001   11101 01101 10 00 10101101    0 0 111 0010 00    1 01 100001 0110 0000 000 11 11 1101 0011001 0 00100 0  01 1011110011 0 11 010 0 1100 1 101 00 1 010000101 0  00010000 1  01110 1001111010111  11 10 1001  1  010 0  1111       0 01000010 11011 0 00 01 01111 01 010 010 100110 0010100111 100101 1110 1 0010 1 100 101 11 1 0 00  01  01 01101 10 000 0 00 111 10000 0   1 0 0 11000001 11  11 1 00110   0 10 0 110011    1 10  0 01011 00 01 1111  1 10  1 01001010 1 10   10 0 010  10   1100  10 0111 01 10 10101 10 01 0 1111   0  11 10 00  000 01 110010  110010101 0  0 010 10  0  1 10  010  101 1 00  001110 10  1 10  10 0 0 1101 101011  100 111  000000 0 101 010 10 10101  00011000011   1 11 10 010 101  1 11000 00 1  111110   11 01 101 0    1 101 0110  111 1111 1011 0 1011101   1100  1     01 011 111   001 0110 11010 1 101   01 11 11001001   00 011 0 0 11 0 1 000 101 1110 0 1 110 0 0   1   110101000 100 1   00010  1  10011010 10 1101 0111   0 1010 00111 0111 1 011101    101000001   1 0010 1010101  111 0100101 00 01 1001101       0101010 1  0 110 01 10 000111 0 1 10   1 1100 11110111 0   0   1 1 10 1 11 0 0  1  0 0 0 01  1 0010 00 111 01 11010011   1 01  10  11 1000 0 11 1 1 10 010   01    01111  1111  00101 11   001  010  1 1 1  1 101001 1111  01 001 1 00 0  0   10 00   1 00 01110101 1  111 1001 0 1 1110100100 0 100101 01 1010 1   001    00 10   0 01  0 1111100010 10 10  0 000
Tag 7 Ur 7 L3                   : 11 0011   1010 1011110011   0 001     1 100010 100  100 1  1 0 101 0 0110 01000 001 10 11   10000110  0 11110 01 00  100011 111 01 10001  1 10 1 00   0  1010 001 00111  1 1110 1 0110 0    0 100 0000 00  110 010 10000  1   111 01010 1 10 0  0 10000110 0  0  0 10  11010  11 11  1001001 0101 0 010 1  0 1 1 011  10 0 100 1  1  00001 0101 00 0  00   0101 10110 0 1 00110 01110011  1 100 1010   001  1 10  111 111  0  1110 0000 1  11010  1 1  00 0100000 10 0   111 0100110 0    10 1  0  01 101 101100 1 10 0100 00001 00110101 000001  110 1010 11 0100  1000100 011000001010 11011111  0  00101101  0010  010110 1101 10 0   11 11011 1 0 100   01 1 1 01111000001010 01  100 0 0 101101 10  0111 011 0 0101 0   111100000 011   110111   11011 1 111 1000 01011  001101  000  110 1110 00 01011 0110 0 00 000 11 0 110110  1 1110   0111  1111 1010101  11  00  11 10  101  10 11 0100  00  10 0 0   010    0   11 1001 1001 11 00 1 01  1  11 01  0 00 00 100 001101000 0 1 1110 0101110 00 0 01   101110010011010 00  0000  110  011100001010  1001   1  1 10 0  0 11  00110 0     0   01111 101 001    0  00100 1111110 0110010001011 01 1 00000010 01000 1  1  01 1 100  00  1 00  1 00  0111  1000010 00   0101    0 10101101 0011 0 0 1   1100 0 110  1 0 101010  11   0001000 0 0100  0010 001  0 0110100 001011 1 000 001001011 110 00001 11110 101   0 11000 0 1 00 1001 1   0 10 0 11   0 0000 00  00 1100100 1  101  0 0000 1101011 00011   1  011 00111 0 11 00 0110 0 00 10 010101 111  0 01   11 00111  10 01 11 1111 000101 01 1 10  1 01001110  111111 10   000 10110  0 0100 1  1 0  11 0 1010000 00 100 0 00100111 0 11 1 0110010  01110 0 011 010 10      1100 1   1  0 1   01001 00 1000 1 0101111  11 1 1  110
Wh 173 R4b B17                  : 01  1 0 011011    01 00010011011100 1 10  1 11 1  000 01000 0001   000011 0 01 00111110010   00110 11110 0 000 101 0001001 0  001 011 00011010111 001111  000011 11111 0010000011 0111  01000010 110 01001 10000 01  111010 10 1  011001 110 010100   0101111 0110001 1 1  01000 01 00001 1 010111 00 0101 011000 1 0011  00111100100 0001  0  0101 0100100   010100  00000000 100100  001001 1 01001100 10100   10  001 1   00110011  0001 110000000 11 0111000110 0101   11  0010 0 0  0101000000  10001 0 0 11   00100 000100 001110010 00000 0 001 101 010 01011 01101 00 010 1111   1 001 10011 011010000 001010 10 100  0011000 1 00 1001 1  0 101 11 00100 0 0  0 1 01000010011010110   0001 00001 0 010  1101110 11  00000 00001010 00010 1 0 0 1100000  010101 010  0 0 011  1000010 1111 01000 0111  010 0100  0010001  0 10001101 1 01  0    1 00 0011 111 00110010 1 00 11100001000 0 000 011 01   001110010000 0111101111 11 00 01010  00  110  0 10111 00 0010 01110101 000 0001 001 10101 10  101 001 1101 101010100 000 0100 001110000 0  01 101110010010 0 000010 01 10101101 10011 0101 00 001011110 10 1 00 011 11101001 001 01 1  11 0001 10101 111001 100 0 010 01 0  1  1101  01111  11 00100  1       01  111  00  100 010 11   0  1  1 11 001 0 101    11        0   00 1 10  110       1 00 110 1  0  1  1  10     01      1 0 1 0   01 00  0   0 0       1      0       00 1 010011     0 0   1   1  00      1000    110 111 0     00    110 1      1 01 0   100011 1   1 1  0     0  1 01      0      00 1100       1 1    10  10  0      010  11  111001 1101  11 00000  0011  0 0111 01 01 111   110 10 10   1 0  1  101  11  1 1  10 0000111111111101 1000100  1 0 01 10 010   011  000   1111    11010 101010  0 1
Tag 6 R3y 313 Ph 4 N7           : 11 00  00 001001 0 1  000  111 01   0 011 1  1001111  00 110 110100 0110   100   010100  11 1 100 100 011  1 00000 010  0 1  11 1  10 00 0 0  0   0000 1  100 1 01000 10 1  1 0 0    00 00 01111 010 010 010 011100101110   0 01  1 0010 11 001 01 111 1 0 0  1001  10  1 11 0   1 00 0  0110 1  0 1   01 0 010  1001011 00110     11010 0 0 10 000  1 100        1 110 01  0111111 1100  1   111  1011110 0110110  00101 1  0 11000 1  0010101 1011 0011  1 01000 111 110  1  11 1 0 1 01 00  1000 10100101 10110 000001101 00 1 01 0  0001 11 0 011 0011 01010  11001 01 1110  01 11  1 0101 000 00110 0 00  110  1 11 010 1 1001 0   0   1101001      0 1  100000 1 01  11 110011  11 01001 1    0 0 00 1  10 1 1000101 1 1 1 0 100  1 0 0110100  1 1 0 10101  00 100  00 0 011 1  1  1111  01110000  010 0 01011 00  10 01  0  0  001110  1 101111  10100001 1100001   10 00 01 0  0 0 01  1   01 11 11 000  1 0 0   1111110 11  101 11 00001  1000001 0 0010000 100001   00 01 110 0001 11  00001  000 111010 01  0111000 00 001  11 01 111  0  11 1  0 010 110 0111 10  0 001 00 0101110 11 0101  10010  10       01 1001 01100  0  1 1100101101  0110 11 0 001 11   0  11 0001  10 0 1 10  0011 100 11 1    1 00      1 11 01100 1  00000101 01 1  1 0 01001 111 10 0 001         1100011100 10 1000 0000001001  1 1 0010010 0 00 00  000101 1 00011100 1 100 0 00011 0000111 1010 0  10000101011101111  11001  1  0 0    0 0001  1 1  11   0 1 010010100010 001 0010  1001  11 10110000  1010100 1 1 00 1000 100 01000 111 1 10   01111 011 0  0 100001101   1100  11111  011 01 1    11 111 11 1 1  011 0111 1 1010 0   0 0 1 101 0  00 0111 111 001000 1101 0010010111100001110 1001  01111100 101100 00    0   01  0110111  0  1  0001
Y3110w 7163R                    :   10 0  1111010 001    11001  0 10 001      1  00111 1 0001 00  001 01 00 1   110 1 10 0 00101 10   0  10 001  101  1    0111 0 011  1  1  10001100 0001  111   0 010 1 110 0 1  00   1001010 1 1010110 1  0 01001     1 00101    110   0010010 0 0  00 11  0 100111  0111111 010  01101 010001 0 01  1101 0  010 01  10 1 001010 10 0 110 00  1 00 0001  0 00 1  11 01 0 0010 0  001000110  00001     1110   11 01 1 00 1  10 100 01 0 11   0 1 01 100 100  1110100   0010   10  1 010 101  0 1 111 001100110001011  11   1110 10  0 1 1   0  10 000   101 00   01 00 1111010 1 01 0010 0  1 001   1 011 00  01 11     0  1011 1 0100101 10 1100    01     11   110010110  110   11  0000101 00  1110   1 110000 0000001 0100 01  0 0 11 0  11 110  10 0  10 100 00000 10 01 0 11 0    1111 1011 1  1   1011 0    01  1111101 0 00 00  1 0  1 11 110 0    10001 100 1  10 0 001 00 0 0 11  00 0 11100 0 000  1 1 01 1   1  1010 10000 110  10 110001   11   1 1 1 01 00 1 001  111 1  0 10 100    0001010  0 0011011 10  1 001 11100      1  0   00 110 0  1 1   0 1 10000  111  0  11   1 11110 111 0  0 1 1 00 100 1 0011 0 01 0000 11 1  01111 00 111001 1   1  100  10 1011   0010 0  10 0  01 1   00 010 111 0 01 00  00 111  1  1 1010 10100 0 10 00 111011111 1  00  11 11010 0 01 1100111111 111100001  1001  0  001 0100 1 11001 1 01 11  01100111010 01 000101 01  00 1011101 100011  10111010  011 1 00011 1      1 01 000  01100 10 11  001 11 0 00 11  0 00001  10 1 111 1 0100 100  11000 1 0 1  110   10 1 0 111   0 01 010 0     0100000 0 0 10 00100  1 1100 1 0 1111000 01 0  010  11 010 0    1 11011110010   01 0111    10010101000 1  0 011   0 00 10 010 1 001 10101  00001 1 0    1 0 110 10 010 10 0  1010 000000000 010
Br 0w NB34r                     : 0 1010 0  10000 0  01100 01101 1  1  11  0 10100 01001011  010 00 0  10100000  0111 11101 00 1 00   100 1  0 001110 011 11 01101 011010 1  1 0   1  0 01  0 10110 10101 001010 1110  01 110  00  0111  01     011 1  00 0 110 0  1011 1   0 01011 1  00 1 0101 101   0 01 0  011 1000100001 1  0 11100 011  00 00  0111100111 10010111100 1 01011   110  0110 110 1  0 0101101  1010  10 1100100 10   1100 01 000 1 11100  0      000   00 01010011  000001000 1 1 11000001   10 101   1000 11 1 10111111 010001 1 11 11 101 0   00  1  0001011101011  11 0011 00 00 00101   1   01  1  0  1111  0   11 1 0 0   01   0101 11   0 010 111 101 001 11 10 001100 011  101  1 00  001  11 0 100  11   01000100101 000 11 11 1110 00101 000000 100 0  001 11011001 01 01 011 111    00 0001000 10 0   0  011111  1 0 1110 10 0 11    1 10  010 111101 1 1 111  0 0 0001 10010 00 100    1  10 111 0  001100 100110 110001100  0001  1 111 010  1   10  0  001 00   00000 1 111011 1 1 01 000  1 0    11 0  100 1 00001 1  1 01100 110   00   0000 0000 0 1011     1 0110 1 100 111  0 11011   0 0001010 1 101 0 01 1 1 101010 0 0 11 110110000 1 0111 111   1 101001 10   01 0 0 1101011000001   1010 1 010 00 01 10 0   0  1100 0 10 000 1  00 0 0 1 0  000 011  1011 1 010001 011  10  00 10 0111111 0  1  01  101 0110 011 01 0 011  01   11011000 10 1 00 01 1 100000110 1  001 0001000 1 0  00  0 0010 01011 11 11  11 01   1   0 1 1 10 010 1 010     01010 0100   110  11 101 000 111101   1  0  01 110001  1  101  00 101001000101110000 00 0111  0 011 0101 1   111  0 111 100010 000000  0   0000 1 11 0  100 0 110  0 1 010 01  0 1110 1 101  1   000    01  1100001  000 1111 10  11 0100 01011 110100  10011   01  101011 1 1111111 0 110
P1n KM0n K3y                    : 0 101 0 0 0001 00  0 1 00  01110 11  1010   0101 0111010 1 1 110   0  001 0 0  0111  101 11 1010 01110 00    0  1  110001   101 01010 1 0111100  1 110 0  1  11 010 1001001    00  01     00011 1 100001  111      10  00011  0 1 01 0  00 11 00 101100 00 100100011111110 0110101110001110 10  11001 00 10 111  011001001 100111  10010   0   1011 1  1001   0 1 0110110011   1 1  11  0 10 1 1   011 10 0  1  00 000   0 0    001011000 11  0110 010 0  00 101111 10110101010001   00000 1 011110 0 10101 0001 0111001011011  0 100 10 0000   110 1 100  010 11 0110 01   010 1010 1  11  011   110  1010 00 00110 1 11 1010 10 1 00  11   01 01 100  1  1 01 101110  1 100 11   111  01  11001011 1 1 11100  11  01  10  11 1 00  10011 0  001010 011001 0 100 1110   1000101  100101 1000  1   001 01 00100 10 00   1 100 111101 10   0 01   10001 0100  0 00   11000 111  111  1000 0 01 1 00110    1  11101 0111 00011  1 100101 0 110000 100  001   0 01 10 0  111111 00 10 0 0000 0 011 1010 11    00010011110 0001 111 01100  1 0 001  1  0101111  10100101101 0  0 111100111 01 0  000 001  1010 0 01 11  0 1 0       01 00 1 10 0 1111101011   010010 1110 0 11   11110 110   10 1001 10 10 1 00001011 1 1     01000111  1   1 0   0101  011  00 101 1 00  11101 0001     11 0 1110 10000 011  0  011 011 011 00  0001 100110101100   00 1   0 1  00 1 1  1 011  1010 101 00  10001 0111 0011   10 01011110101 0 01110   1 1   00  00 111010  0  1 1 1   011 0 00 1 100  00 1101000   01  100 0000 1  101100  01    1 1 10  0110   01 0 101   10 11 001 010111 11000 0 0100010  0 11 10  00110 01000 00  1 0 1 011 100 101 10  1 0  0111 10101001101 1 1011111000 0 0 01 111011111 111 01 111  0 1000 111 0  0   1     010 110 0001 00
Image Size                      : 410x410
Megapixels                      : 0.168
```

As the QR Code read follow the `white rabbit`, the extract the `Wh 173 R4b B17` portion from the metadata.

At this stage, we didn't have much clue what to do, we assumed that the numbers in the metadata somehow formed a QR Code. 
The length of the data section is 1681 characters which is 41 x 41. Furthermore, the image was 410 x 410 pixel. 

After a lot of trial and error, we eventually stumbled upon this [python module](https://pypi.org/project/qrcode/) that generates and reads QR Codes.

```python
import qrcode

qr = qrcode.QRCode()
qr.add_data('This is the key. Now... follow the white rabbit.')
matrix = qr.get_matrix()
print matrix
```

This resulted in a 41 x 41 boolean array, so we figured maybe the QR Code itself was the key...

```python
import qrcode

qr = qrcode.QRCode()
qr.add_data('This is the key. Now... follow the white rabbit.')
matrix = qr.get_matrix()

rabbit = "01  1 0 011011    01 00010011011100 1 10  1 11 1  000 01000 0001   000011 0 01 00111110010   00110 11110 0 000 101 0001001 0  001 011 00011010111 001111  000011 11111 0010000011 0111  01000010 110 01001 10000 01  111010 10 1  011001 110 010100   0101111 0110001 1 1  01000 01 00001 1 010111 00 0101 011000 1 0011  00111100100 0001  0  0101 0100100   010100  00000000 100100  001001 1 01001100 10100   10  001 1   00110011  0001 110000000 11 0111000110 0101   11  0010 0 0  0101000000  10001 0 0 11   00100 000100 001110010 00000 0 001 101 010 01011 01101 00 010 1111   1 001 10011 011010000 001010 10 100  0011000 1 00 1001 1  0 101 11 00100 0 0  0 1 01000010011010110   0001 00001 0 010  1101110 11  00000 00001010 00010 1 0 0 1100000  010101 010  0 0 011  1000010 1111 01000 0111  010 0100  0010001  0 10001101 1 01  0    1 00 0011 111 00110010 1 00 11100001000 0 000 011 01   001110010000 0111101111 11 00 01010  00  110  0 10111 00 0010 01110101 000 0001 001 10101 10  101 001 1101 101010100 000 0100 001110000 0  01 101110010010 0 000010 01 10101101 10011 0101 00 001011110 10 1 00 011 11101001 001 01 1  11 0001 10101 111001 100 0 010 01 0  1  1101  01111  11 00100  1       01  111  00  100 010 11   0  1  1 11 001 0 101    11        0   00 1 10  110       1 00 110 1  0  1  1  10     01      1 0 1 0   01 00  0   0 0       1      0       00 1 010011     0 0   1   1  00      1000    110 111 0     00    110 1      1 01 0   100011 1   1 1  0     0  1 01      0      00 1100       1 1    10  10  0      010  11  111001 1101  11 00000  0011  0 0111 01 01 111   110 10 10   1 0  1  101  11  1 1  10 0000111111111101 1000100  1 0 01 10 010   011  000   1111    11010 101010  0 1"

flag = ''

i = 0
for bArray in matrix:
    for b in bArray:
        if(b):
            flag += rabbit[i]
        i = i + 1

print flag
```

The output looked promising, 
```
01000001 01000110 01000110 01000011 01010100 01000110 01111011 00110000 01101000 00100000 01100100 00110011 01100001 01110010 00100001 00100000 00110000 01101000 00100000 01100100 00110011 00110100 01110010 00100001 00100000 00110001 00100000 00110101 01101000 00110100 00110001 00110001 00100000 01100010 00110011 00100000 00110111 00110000 00110000 00100000 00110001 00110100 01110100 00110011 00100001 01111101
```

Converting it from Binary to Ascii:
```python
print unhexlify(hex(int(flag.replace(' ',''),2))[2:-1])
```

Flag: **AFFCTF{0h d3ar! 0h d34r! 1 5h411 b3 700 14t3!}**
